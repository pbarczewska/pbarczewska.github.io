<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>P. A. Barczewska</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400&family=Playfair+Display:wght@500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

<style>
:root{ --radius: 35px; --shadow: 0 10px 40px rgba(0,0,0,0.2); }
*{ box-sizing:border-box; }
body{ margin:0; font-family:"Inter", sans-serif; color:#151515; background-image:url("file_000000006408722fa2ddd16807e0f8b7.png"); background-size:cover; background-position:center; background-attachment:fixed; min-height:100vh; }
body::before{ content:""; position:fixed; inset:0; background:rgba(0,0,0,0.35); z-index:-1; }

header{ max-width:980px; margin:24px auto 0; padding:0 18px; display:flex; align-items:center; gap:14px; color:#fff; }
.logo{ width:64px; height:64px; border-radius:50%; background:#fff; object-fit:cover; box-shadow:0 10px 30px rgba(0,0,0,0.3); cursor:pointer; }
header h1{ font-family:"Playfair Display", serif; font-size:1.5rem; margin:0; }

.hero{ max-width:980px; margin:20px auto; padding:80px 20px; border-radius:var(--radius); background:rgba(255,255,255,0.15); backdrop-filter: blur(15px); border:1px solid rgba(255,255,255,0.2); text-align:center; color:#fff; box-shadow: var(--shadow); }
.hero h2{ font-family:"Playfair Display", serif; font-size:2.5rem; margin:0; }

main{ max-width:980px; margin:0 auto; padding:0 18px; }
section{ background:rgba(255,255,255,0.78); backdrop-filter: blur(12px); border-radius:var(--radius); box-shadow:var(--shadow); padding:35px 30px; margin-bottom:25px; border: 1px solid rgba(255,255,255,0.3); }
section h2{ font-family:"Playfair Display", serif; font-size:1.8rem; margin:0 0 15px; }
section p{ font-size:0.97rem; line-height:1.7; margin:0 0 12px; }

.post-preview{ margin-top:22px; padding-top:20px; border-top:1px solid rgba(0,0,0,0.1); }
.post-preview h3{ font-family:"Playfair Display", serif; font-size:1.25rem; margin:0 0 8px; }
.read-more{ display:inline-block; margin-top:10px; text-decoration:none; color:#111; font-weight:600; border-bottom:1px solid #111; padding-bottom:2px; }

footer{ color:rgba(255,255,255,0.85); font-size:0.9rem; text-align:center; padding-bottom:60px; }
</style>
</head>

<body>

<header>
  <img id="secretLogo" class="logo" src="file_000000001f04720c8a514e8f7c6decad.png" alt="Logo">
  <div>
    <h1>P. A. Barczewska</h1>
    <p>Pisarka emocji. Kryminologia z ciekawości.</p>
  </div>
</header>

<div class="hero">
  <h2>P. A. Barczewska</h2>
  <p>Pisarka emocji. Kryminologia z ciekawości.</p>
</div>

<main>
<section>
<h2>Teksty</h2>

<!-- RĘCZNE WPISY – ZOSTAJĄ -->
<article class="post-preview">
  <h3>Najlepsze rzeczy dzieją się w ciszy</h3>
  <p>Czasem nie potrzeba odpowiedzi. Wystarczy zostać na chwilę w miejscu, w którym coś zaczyna być prawdziwe…</p>
  <a class="read-more" href="teksty/najlepsze-rzeczy.html">Czytaj dalej</a>
</article>

<article class="post-preview">
  <h3>Między strachem a decyzją</h3>
  <p>Każda decyzja ma swój moment graniczny. Ten, w którym ciało wie wcześniej niż my…</p>
  <a class="read-more" href="teksty/miedzy-strachem.html">Czytaj dalej</a>
</article>

<!-- CONTENTFUL -->
<div id="dynamic-posts"></div>

</section>
</main>

<footer>
<p>© <span id="year"></span> P. A. Barczewska</p>
</footer>

<script>
document.getElementById("year").textContent = new Date().getFullYear();

const SPACE_ID = "4njr98q3c6g4";
const ENV = "master";
const TOKEN = "FqnzOZKFLkbxgkOlf35AU9326HVpYkJ6jUhClOE98";
const TYPE = "article";

function pickLocale(field){
  if(!field) return "";
  return field["pl-PL"] || field["en-US"] || "";
}

function richToText(r){
  if(!r || !r.content) return "";
  let out=[];
  (function walk(n){
    if(n.nodeType==="text") out.push(n.value);
    if(n.content) n.content.forEach(walk);
  })(r);
  return out.join(" ").trim();
}

async function loadDynamicPosts(){
  const box = document.getElementById("dynamic-posts");
  const url =
    `https://cdn.contentful.com/spaces/${SPACE_ID}/environments/${ENV}/entries`+
    `?access_token=${TOKEN}&content_type=${TYPE}&order=-sys.createdAt`;

  const res = await fetch(url);
  const data = await res.json();
  if(!data.items) return;

  data.items.forEach(item=>{
    const title = pickLocale(item.fields.title);
    const text = richToText(pickLocale(item.fields.content));

    if(!title) return;

    const el = document.createElement("article");
    el.className="post-preview";
    el.innerHTML =
      `<h3>${title}</h3>
       <p>${text.slice(0,160)}…</p>
       <a class="read-more" href="view.html?id=${item.sys.id}">Czytaj dalej</a>`;
    box.appendChild(el);
  });
}

loadDynamicPosts();

/* 4x logo → Contentful */
let c=0,t=null;
secretLogo.onclick=()=>{
  c++; clearTimeout(t);
  t=setTimeout(()=>c=0,1500);
  if(c>=4) location.href=`https://app.contentful.com/spaces/${SPACE_ID}/environments/${ENV}/entries`;
};
</script>

</body>
</html>
