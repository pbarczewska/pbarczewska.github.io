<!doctype html>
<html lang="pl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Czytasz tekst - P. A. Barczewska</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400&family=Playfair+Display:wght@500;600&display=swap" rel="stylesheet">
<style>
body{ margin:0; font-family:"Inter",sans-serif; background:#f4f4f4; color:#151515; line-height:1.8; }
article{ max-width:800px; margin:40px auto; background:#fff; padding:40px; border-radius:18px; box-shadow:0 10px 30px rgba(0,0,0,.1); }
h1{ font-family:"Playfair Display",serif; font-size:2.5rem; margin-bottom:20px; }
.back-link{ display:inline-block; margin-bottom:20px; text-decoration:none; color:#666; font-size:.9rem; }
#post-content p { margin-bottom: 1.5rem; }
</style>
</head>
<body>
<article>
  <a href="index.html" class="back-link">← Wróć do strony głównej</a>
  <div id="post-content">Ładowanie treści…</div>
</article>

<script>
const SPACE_ID = "4njr98q3c6g4";
const TOKEN    = "GjcqWIsIud_ukRdgbQPJrzwsRbwkBxO4g5K6-SMwE2Y";

const params = new URLSearchParams(window.location.search);
const ENTRY_ID = params.get("id");
const box = document.getElementById("post-content");

async function loadPost() {
  if(!ENTRY_ID) return;
  const url = `https://cdn.contentful.com/spaces/${SPACE_ID}/environments/master/entries/${ENTRY_ID}?access_token=${TOKEN}&locale=*`;
  
  try {
    const res = await fetch(url);
    const data = await res.json();
    const localeKey = Object.keys(data.fields.title)[0];
    
    const title = data.fields.title[localeKey];
    const content = data.fields.content[localeKey];

    document.title = title + " - P. A. Barczewska";
    box.innerHTML = `<h1>${title}</h1>` + renderRichText(content);
  } catch(e) {
    box.textContent = "Błąd pobierania tekstu.";
  }
}

function renderRichText(nodes) {
  if(!nodes || !nodes.content) return "";
  return nodes.content.map(node => {
    if(node.nodeType === "paragraph") {
      const text = node.content.map(c => c.value).join("");
      return `<p>${text}</p>`;
    }
    return "";
  }).join("");
}

loadPost();
</script>
</body>
</html>
